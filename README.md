# CRM ì‹œìŠ¤í…œ

ê°„ë‹¨í•œ ê³ ê° ê´€ê³„ ê´€ë¦¬(CRM) ì‹œìŠ¤í…œì…ë‹ˆë‹¤. Flaskë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

## ì£¼ìš” ê¸°ëŠ¥

### 1. ê³ ê° ê´€ë¦¬
- **ê³ ê° ë“±ë¡**: ì´ë¦„, ì—°ë½ì²˜, ìƒë…„ì›”ì¼, ì„±ë³„, ë©”ëª¨
- **ê³ ê° ëª©ë¡ ì¡°íšŒ**: ì „ì²´ ë¦¬ìŠ¤íŠ¸, ê²€ìƒ‰(ì´ë¦„/ë²ˆí˜¸/ìƒì¼)
- **ê³ ê° ì •ë³´ ìˆ˜ì •/ì‚­ì œ**: ì…ë ¥ê°’ ìˆ˜ì •, ì‚­ì œ ì „ í™•ì¸ íŒì—…
- **ìƒì¼ì í•„í„°**: ì´ë²ˆë‹¬ ìƒì¼ ê³ ê°ë§Œ ë³´ê¸°

### 2. ë°©ë¬¸ ê¸°ë¡
- **ë°©ë¬¸ ë“±ë¡**: ê³ ê° ì„ íƒ í›„ ë°©ë¬¸ì¼, ë©”ëª¨ ê¸°ë¡
- **ê³ ê°ë³„ ë°©ë¬¸ ë‚´ì—­**: ê³ ê° ìƒì„¸ í˜ì´ì§€ì—ì„œ í™•ì¸
- **ê¸°ê°„ë³„ ë°©ë¬¸ ê¸°ë¡**: ì‹œì‘ì¼/ì¢…ë£Œì¼ë¡œ í•„í„°ë§

### 3. ê²°ì œ ê´€ë¦¬
- **ê²°ì œ ë“±ë¡**: ë°©ë¬¸ ê¸°ë¡ ì„ íƒ í›„ ê²°ì œ ê¸ˆì•¡, ê²°ì œìˆ˜ë‹¨ ê¸°ë¡
- **ê²°ì œ ë‚´ì—­ ì¡°íšŒ**: ì „ì²´ ê²°ì œ ë‚´ì—­ í™•ì¸
- **ê³ ê°ë³„ ê²°ì œ ë‚´ì—­**: ê³ ê° ìƒì„¸ í˜ì´ì§€ì—ì„œ í™•ì¸

### 4. í†µê³„ ê¸°ëŠ¥
- **ì „ì²´ í†µê³„**: ì´ ê³ ê°ìˆ˜, ì´ ë°©ë¬¸ìˆ˜, ì´ ë§¤ì¶œ, í‰ê·  ê²°ì œê¸ˆì•¡
- **ê³ ê°ë³„ í†µê³„**: ê³ ê°ë³„ ì´ ë°©ë¬¸íšŸìˆ˜, ì´ ê²°ì œê¸ˆì•¡, í‰ê·  ê²°ì œê¸ˆì•¡
- **ì›”ë³„ í†µê³„**: ì›”ë³„ ë§¤ì¶œ ë° ë°©ë¬¸ í†µê³„
- **ëŒ€ì‹œë³´ë“œ**: ì£¼ìš” ì§€í‘œë¥¼ í•œëˆˆì— í™•ì¸

##  ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### ERD (Entity Relationship Diagram)
![CRM ERD](docs/crm_erd.png)

### í…Œì´ë¸” êµ¬ì¡°

#### 1. customer (ê³ ê° í…Œì´ë¸”)
- `customer_id`: ê³ ê° ê³ ìœ  ID (Primary Key, Auto Increment)
- `name`: ê³ ê° ì´ë¦„ (VARCHAR(20), NOT NULL)
- `phone`: ì—°ë½ì²˜ (VARCHAR(20))
- `birth_date`: ìƒë…„ì›”ì¼ (DATE)
- `gender`: ì„±ë³„ (CHAR(1))
- `memo`: ë©”ëª¨ (TEXT)

#### 2. visit (ë°©ë¬¸ í…Œì´ë¸”)
- `visit_id`: ë°©ë¬¸ ê³ ìœ  ID (Primary Key, Auto Increment)
- `customer_id`: ê³ ê° ID (Foreign Key â†’ customer.customer_id)
- `visit_date`: ë°©ë¬¸ì¼ì‹œ (DATETIME, NOT NULL)
- `memo`: ë°©ë¬¸ ë©”ëª¨ (TEXT)

#### 3. payment_method (ê²°ì œìˆ˜ë‹¨ ì½”ë“œ í…Œì´ë¸”)
- `method_code`: ê²°ì œìˆ˜ë‹¨ ì½”ë“œ (Primary Key, VARCHAR(20))
- `method_name`: ê²°ì œìˆ˜ë‹¨ ì´ë¦„ (VARCHAR(20), NOT NULL)

#### 4. payment (ê²°ì œ í…Œì´ë¸”)
- `payment_id`: ê²°ì œ ê³ ìœ  ID (Primary Key, Auto Increment)
- `visit_id`: ë°©ë¬¸ ID (Foreign Key â†’ visit.visit_id)
- `amount`: ê²°ì œ ê¸ˆì•¡ (INT, NOT NULL, >= 0)
- `payment_method_code`: ê²°ì œìˆ˜ë‹¨ ì½”ë“œ (Foreign Key â†’ payment_method.method_code)
- `payment_datetime`: ê²°ì œì¼ì‹œ (DATETIME, NOT NULL)

### ê´€ê³„
- **customer â†” visit**: 1:N ê´€ê³„ (í•œ ê³ ê°ì´ ì—¬ëŸ¬ ë²ˆ ë°©ë¬¸ ê°€ëŠ¥)
- **visit â†” payment**: 1:N ê´€ê³„ (í•œ ë°©ë¬¸ì— ì—¬ëŸ¬ ê²°ì œ ê°€ëŠ¥)
- **payment_method â†” payment**: 1:N ê´€ê³„ (í•˜ë‚˜ì˜ ê²°ì œìˆ˜ë‹¨ìœ¼ë¡œ ì—¬ëŸ¬ ê²°ì œ ê°€ëŠ¥)

## ì„¤ì¹˜ ë° ì‹¤í–‰

### 1. í™˜ê²½ ì„¤ì •
```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv py-crm-venv
py-crm-venv\Scripts\activate    # Windows
source py-crm-venv/bin/activate # Linux/Mac

# í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
1. MySQL ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
2. `app/config.py` íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì •ë³´ ì„¤ì •
3. `.env` íŒŒì¼ ìƒì„±:
```bash
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=crm_db
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```bash
# SQL ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
mysql -u root -p crm_db < scripts/sql/crm_ddl.sql
mysql -u root -p crm_db < scripts/sql/init_payment_method.sql
```

### 4. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
```bash
python main.py
```
ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:5000`ìœ¼ë¡œ ì ‘ì†í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## í˜ì´ì§€ êµ¬ì„±

### ë©”ì¸ í˜ì´ì§€
- **ëŒ€ì‹œë³´ë“œ**: ì „ì²´ í†µê³„, ì´ë²ˆë‹¬ ìƒì¼ ê³ ê°, ìµœê·¼ ë°©ë¬¸ ê¸°ë¡

### ê³ ê° ê´€ë¦¬
- **ê³ ê° ëª©ë¡**: ê²€ìƒ‰, í•„í„°ë§
- **ê³ ê° ë“±ë¡**: ìƒˆ ê³ ê° ì •ë³´ ì…ë ¥
- **ê³ ê° ìƒì„¸**: ê³ ê° ì •ë³´, í†µê³„, ë°©ë¬¸ ê¸°ë¡, ê²°ì œ ë‚´ì—­
- **ê³ ê° ìˆ˜ì •**: ê¸°ì¡´ ê³ ê° ì •ë³´ ìˆ˜ì •

### ë°©ë¬¸ ê¸°ë¡
- **ë°©ë¬¸ ëª©ë¡**: ì „ì²´ ë°©ë¬¸ ê¸°ë¡, ê¸°ê°„ë³„ í•„í„°ë§
- **ë°©ë¬¸ ë“±ë¡**: ê³ ê° ì„ íƒ í›„ ë°©ë¬¸ ì •ë³´ ì…ë ¥
- **ë°©ë¬¸ ìˆ˜ì •**: ë°©ë¬¸ ìˆ˜ì •

### ê²°ì œ ê´€ë¦¬
- **ê²°ì œ ëª©ë¡**: ì „ì²´ ê²°ì œ ë‚´ì—­
- **ê²°ì œ ë“±ë¡**: ë°©ë¬¸ ê¸°ë¡ ì„ íƒ í›„ ê²°ì œ ì •ë³´ ì…ë ¥

### í†µê³„
- **í†µê³„ ëŒ€ì‹œë³´ë“œ**: ì „ì²´ í†µê³„, ì´ë²ˆë‹¬ í†µê³„, ì›”ë³„ í†µê³„
- **ê³ ê°ë³„ í†µê³„**: ê° ê³ ê°ì˜ ìƒì„¸ í†µê³„ ì •ë³´

## ê¸°ìˆ  ìŠ¤íƒ
- **Backend**: Python Flask
- **Frontend**: HTML, CSS(Bootstrap 5), JavaScript
- **Template Engine**: Jinja2
- **Database**: MySQL
- **ORM**: mysql-connector-python (Native SQL)

## ğŸ“ íŒŒì¼ êµ¬ì¡°
```
py-crm-lite/
â”œâ”€â”€ app/                    # í•µì‹¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ config.py           # ì„¤ì • ê´€ë¦¬ (ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì •ë³´)
â”‚   â”œâ”€â”€ database.py         # ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë° ì¿¼ë¦¬ ì‹¤í–‰
â”‚   â”œâ”€â”€ customer.py         # ê³ ê° ê´€ë¦¬ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ visit.py            # ë°©ë¬¸ ê´€ë¦¬ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ payment.py          # ê²°ì œ ê´€ë¦¬ ëª¨ë“ˆ
â”‚   â””â”€â”€ stats.py            # í†µê³„ ê´€ë¦¬ ëª¨ë“ˆ
â”œâ”€â”€ apis/                  
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ tests/                  # í…ŒìŠ¤íŠ¸ ì½”ë“œ
â”‚   â”œâ”€â”€ conftest.py         # pytest ì„¤ì •
â”‚   â”œâ”€â”€ test_customer.py    # ê³ ê° ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test_visit.py       # ë°©ë¬¸ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
â”‚   â”œâ”€â”€ test_payment.py     # ê²°ì œ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
â”‚   â””â”€â”€ test_stats.py       # í†µê³„ ëª¨ë“ˆ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ scripts/                # ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í¬ë¦½íŠ¸
â”‚   â””â”€â”€ sql/
â”‚       â”œâ”€â”€ crm_ddl.sql     # í…Œì´ë¸” ìƒì„± ìŠ¤í¬ë¦½íŠ¸
â”‚       â””â”€â”€ init_payment_method.sql  # ê²°ì œìˆ˜ë‹¨ ì´ˆê¸° ë°ì´í„°
â”œâ”€â”€ templates/              # HTML í…œí”Œë¦¿ (Jinja2 ì‚¬ìš©)
â”‚   â”œâ”€â”€ base.html           # ê³µí†µ ë ˆì´ì•„ì›ƒ í…œí”Œë¦¿
â”‚   â”œâ”€â”€ dashboard.html      # ëŒ€ì‹œë³´ë“œ ë©”ì¸ í˜ì´ì§€ í…œí”Œë¦¿
â”‚   â”œâ”€â”€ customers/          # ê³ ê° ê´€ë ¨ í™”ë©´ í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ detail.html     # ê³ ê° ìƒì„¸ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ edit.html       # ê³ ê° ìˆ˜ì • í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ list.html       # ê³ ê° ëª©ë¡ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ new.html        # ê³ ê° ë“±ë¡ í˜ì´ì§€
â”‚   â”œâ”€â”€ payments/           # ê²°ì œ ê´€ë ¨ í™”ë©´ í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ list.html       # ê²°ì œ ëª©ë¡ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ new.html        # ê²°ì œ ë“±ë¡ í˜ì´ì§€
â”‚   â”œâ”€â”€ stats/              # í†µê³„ ê´€ë ¨ í™”ë©´ í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ customers.html  # ê³ ê°ë³„ í†µê³„ í˜ì´ì§€
â”‚   â”‚   â””â”€â”€ dashboard.html  # í†µê³„ ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”‚   â””â”€â”€ visits/             # ë°©ë¬¸ ê´€ë ¨ í™”ë©´ í…œí”Œë¦¿
â”‚       â”œâ”€â”€ edit.html       # ë°©ë¬¸ ìˆ˜ì • í˜ì´ì§€
â”‚       â”œâ”€â”€ list.html       # ë°©ë¬¸ ëª©ë¡ í˜ì´ì§€
â”‚       â””â”€â”€ new.html        # ë°©ë¬¸ ë“±ë¡ í˜ì´ì§€
â”œâ”€â”€ docs/                   # ë¬¸ì„œ
â”‚   â””â”€â”€ crm_erd.png         # ë°ì´í„°ë² ì´ìŠ¤ ERD ì´ë¯¸ì§€
â”œâ”€â”€ py-crm-venv/            # Python ê°€ìƒí™˜ê²½
â”œâ”€â”€ main.py                 # ë©”ì¸ ì‹¤í–‰ íŒŒì¼ (Flask ì•±)
â”œâ”€â”€ main copy.py            
â”œâ”€â”€ requirements.txt        # ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ëª©ë¡
â”œâ”€â”€ pytest.ini              # pytest ì„¤ì • íŒŒì¼
â”œâ”€â”€ .env                    # í™˜ê²½ ë³€ìˆ˜ (ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì •ë³´)
â”œâ”€â”€ .gitignore             
â””â”€â”€ README.md               # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

